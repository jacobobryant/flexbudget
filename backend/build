#!/bin/bash
set -x
set -e

function repl {
  export DATOMIC_ENV_MAP="$(cat env.edn)"
  clj -A:dev:local -e "(do (nrepl) (go))" -r
}

function push {
  clojure -A:dev -m datomic.ion.dev "{:op :push :uname \"$(uuidgen)\"}"
  #clojure -A:dev -m datomic.ion.dev "{:op :push}"
}

function proxy {
  datomic-socks-proxy bud
}

function deploy {
  mv .gitbak .git
  git commit -a -m hey
  git status
  read -p "look good? "
  iondeploy
  mv .git .gitbak
}

cmd="$1"
shift
$cmd "$@"
